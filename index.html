<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Spring MVC 3.1 In-Depth</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  
    <link rel="stylesheet" href="file/style.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none">
  <div class="content subsection" ref="intro/slides">
<h1>Spring MVC 3.1 In-Depth</h1>

<br><br>


<h2>Rossen Stoyanchev</h2>

<h3><em>SpringSource, VMware</em></h3></br>
</br>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="java-config/slides/1">
<h1>MVC Java Config Design</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="java-config/slides/2">
<h1>Design goals</h1>

<ul>
<li>A simple starting point</li>
<li>Transparency</li>
<li>Flexibility</li>
<li>A path from simple to advanced</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/3">
<h1>Why does it matter?</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/4">
<h2>It's a relatively simple mechanism worth understanding</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/5">
<h2>You may use for your own purposes, e.g.</h2>

<h2>to design your your own <code>@EnableXyz</code></h2></div>
</div><div class="slide" data-transition="none"><div class="content small" ref="java-config/slides/6">
<h1>A simple starting point</h1>

<pre class="sh_java"><code>
    @EnableWebMvc
    @Configuration
    public class WebConfig {

    }</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/7">
<h2>No base class</h2>

<h2>No Spring MVC beans in sight</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="java-config/slides/8">
<h1>What it provides</h1>

<ul>
<li>@MVC request processing</li>
<li><code>ConversionService</code></li>
<li>Global JSR-303 validator</li>
<li><code>HttpMessageConverter</code> registrations</li>
<li>A few others</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="java-config/slides/9">
<h1>What can be customized</h1>

<ul>
<li>Implement <code>WebMvcConfigurer</code></li>
<li>Or extend <code>WebMvcConfigurerAdapter</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/10">
<h2>Still no Spring beans</h2>

<h2>Implement an interface and magic happens</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/11">
<h1>Demo</h1>

<h2><a href="https://github.com/SpringSource/spring-framework-issues/tree/master/SPR-0000-war-java">SPR-0000-war-java</a></h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/12">
<h2>No Spring beans</h2>

<h2>Implement an interface and magic happens</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/13">
<h1>How does it work?</h1></div>
</div><div class="slide" data-transition="none"><div class="content small" ref="java-config/slides/14">
<pre class="sh_java"><code>
    @EnableWebMvc  // &lt;-- What's behind?
    @Configuration
    public class WebConfig {

    }</code></pre></div>
</div><div class="slide" data-transition="scrollLeft"><div class="content small" ref="java-config/slides/15">
<h1><code>@EnableWebMvc</code></h1>

<pre class="sh_java"><code>
    @Retention(RetentionPolicy.RUNTIME)
    @Import(DelegatingWebMvcConfiguration.class)
    @Target(ElementType.TYPE)
    public @interface EnableWebMvc {

    }</code></pre></div>
</div><div class="slide" data-transition="fade"><div class="content small" ref="java-config/slides/16">
<h1><code>@EnableWebMvc</code></h1>

<pre class="sh_java"><code>

    @Import(DelegatingWebMvcConfiguration.class)

    public @interface EnableWebMvc {

    }</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/17">
<h2>The configuration is imported</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="java-config/slides/18">
<h1><code>WebMvcConfigurationSupport</code></h1>

<ul>
<li>Contains the imported configuration</li>
<li>Uses <code>@Bean</code> methods</li>
<li>Just like your configuration</li>
<li>Easy to read</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/19">
<h1>Demo</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/20">
<h2>How does importing the configuration allow for customizations?</h2></div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/21">
<h2>Recall that we</h2>

<h2>implement an interface and magic happens</h2></div>
</div><div class="slide" data-transition="none"><div class="content smaller bullets incremental" ref="java-config/slides/22">
<h1><code>DelegatingWebMvcConfigurationSupport</code></h1>

<ul>
<li>A sub-class of <code>WebMvcConfigurationSupport</code></li>
<li>"Detects" <code>WebMvcConfigurer</code> implementations</li>
<li>Via <code>@Autowired</code></li>
<li>Delegates to detected instances to customize the config</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="java-config/slides/23">
<h2>However at any point you can switch</h2>

<h2>to extending directly from</h2>

<h2><strong><code>WebMvcConfigurationSupport</code></strong></h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="java-config/slides/24">
<h2>Extending directly from <code>WebMvcConfigurationSupport</code></h2>

<ul>
<li>Remove <code>@EnableWebMvc</code></li>
<li>i.e. don't import</li>
<li>Extend <code>WebMvcConfigurationSupport</code></li>
<li>Override <code>@Bean</code> and other available methods</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="infrastructure/ slides/1">
<h1>The New <br> @MVC Support Classes</br></h1>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/2">
<h1>Old</h1>

<h2><code>DefaultAnnotationHandlerMapping</code>, <code>AnnotationMethodHandlerAdapter</code>, <code>AnnotationMethodExceptionResolver</code></h2>

<br>


<h1>New</h1>

<h2><code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code>, <code>ExceptionHandlerExceptionResolver</code></h2></br>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/3">
<h1>Why the re-write?</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/4">
<h1>General Background</h1>

<ul>
<li>JIRA tickets for more flexibility</li>
<li>A few functional limitations</li>
<li>A few tricky request mapping semantics</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/5">
<h1>The ticket that</h1>

<h1>happened to tip the balance</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="infrastructure/ slides/6">
<h1><a href="https://jira.springsource.org/browse/SPR-7345">SPR-7345</a></h1>

<ul>
<li>Relatively insignificant</li>
<li>Not many comments</li>
<li>Nevertheless worth a closer look</li>
<li>A representative example</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="infrastructure/ slides/7">
<h1>The issue</h1>

<ul>
<li>404 expected</li>
<li>405 (<code>METHOD_NOT_SUPPORTED</code>) returned</li>
<li>?</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/8">
<h1>The code</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller
public FooController {



  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }


}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/9">
<h1>The code</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html    &lt;- Accept header

@Controller
public FooController {



  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")  // No match
  public @ResponseBody Foo getValue() {

  }


}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/10">
<h1>Old @MVC</h1>

<h1>Request Mapping Process</h1>

<ul>
<li>Two stages</li>
<li><code>HandlerMapping</code> selects controller</li>
<li><span style="color:blue">Perhaps not from annotations!</span></li>
<li><code>HandlerAdapter</code> narrows down the method</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/11">
<h2>Designed to work with</h2>

<h2>different <code>HandlerMapping</code> types</h2>

<h2>E.g.</h2>

<h2><code>SimpleUrlHandlerMapping</code> <br> and others</br></h2>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/12">
<h1>Sounds reasonable but..</h1>

<ul>
<li>Controller is chosen mainly based on URL <code>+</code> type-level <code>@RequestMapping</code> attributes</li>
<li>Method-level <code>@RequestMapping</code> attributes deferred to <code>HandlerAdapter</code></li>
<li>Splits decision making process</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/13">
<h1>Back to the code</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller
public FooController {




  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }


}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/14">
<h1>Back to the code</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller  // (1) Controller selected based on "/foo"
public FooController {




  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }


}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/15">
<h1>Back to the code</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller  // (1) Controller selected based on "/foo"
public FooController {

  // (2) Only to find later that method doesn't match


  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }


}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/16">
<h1>Back to the code</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller  // (1) Controller selected based on "/foo"
public FooController {

  // (2) Only to find later that method doesn't match
  // (3) Harder to reason at this stage about the error

  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }


}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/17">
<h1>Other limitations of prior approach</h1>

<ul>
<li>One URL per controller</li>
<li>Controller method not known to <code>HandlerInterceptor</code></li>
<li>Ditto for <code>HandlerExceptionResolver</code></li>
<li>Harder to reason about the process</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/18">
<h1>New @MVC</h1>

<ul>
<li><code>HandlerMethod</code> abstraction</li>
<li>Think of methods as endpoints</li>
<li>Each endpoint must be uniquely mapped!</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/19">
<h1>A single point of decision</h1>

<ul>
<li><code>HandlerMapping</code> selects a <code>HandlerMethod</code></li>
<li>Not a controller</li>
<li><code>HandlerAdapter</code> invokes selected method</li>
<li>Doesn't know how it's chosen</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/20">
<h1>The code re-visited with 3.1</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller
public FooController {




  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/21">
<h1>The code re-visited with 3.1</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller
public FooController {

  // A single point of decision


  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/22">
<h1>The code re-visited with 3.1</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller
public FooController {

  // A single point of decision
  // Result is 406 (NOT_ACCEPTABLE)

  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  headers="Accept=text/plain")
  public @ResponseBody Foo getValue() {

  }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/23">
<h1>The code re-visited with 3.1</h1>

<pre class="sh_java"><code>
// GET /foo Accept=text/html

@Controller
public FooController {

  // A single point of decision
  // Result is 406 (NOT_ACCEPTABLE)

  @RequestMapping(value = "/foo",
                  method=RequestMethod.GET, 
                  produces="text/plain") // &lt;-- produces
  public @ResponseBody Foo getValue() {

  }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/24">
<h1>Other limitations lifted</h1>

<ul>
<li>Same URL processing can be <br> split across controllers</br>
<li>Controller method known to <code>HandlerInterceptor</code>, <code>HandlerExceptionResolver</code></li>
</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/25">
<h1>Demo</h1>

<h2><a href="https://github.com/rstoyanchev/spring-mvc-31-demo">spring-mvc-31-demo</a></h2>

<br>


</br>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/26">
<h2>Incidentally after the 3.1 release we had this ticket</h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/27">
<h1><a href="https://jira.springsource.org/browse/SPR-9063">SPR-9063</a></h1>

<ul>
<li>The following code worked in 3.0</li>
<li>Treated as "ambiguous mapping" in 3.1</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/28">
<h1>The code</h1>

<pre class="sh_java"><code>


@Controller
@RequestMapping(value = "/foo",
    method = {RequestMethod.GET, RequestMethod.POST })
public class FooController {

    @RequestMapping(method = RequestMethod.GET)
    public String index() {
        return "form";
    }

    @RequestMapping(method = RequestMethod.POST)
    public String submit() {
        return "success";
    }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/29">
<h1>The code</h1>

<pre class="sh_java"><code>
// Can you guess why {GET, POST} are on the type level?

@Controller
@RequestMapping(value = "/foo",
    method = {RequestMethod.GET, RequestMethod.POST })
public class FooController {

    @RequestMapping(method = RequestMethod.GET)
    public String index() {
        return "form";
    }

    @RequestMapping(method = RequestMethod.POST)
    public String submit() {
        return "success";
    }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/30">
<h1>The code</h1>

<pre class="sh_java"><code>
// Note the extra type-level HTTP methods!

@Controller
@RequestMapping(value = "/foo",
    method = {RequestMethod.GET, RequestMethod.POST })
public class FooController {

    @RequestMapping(method = RequestMethod.GET)
    public String index() {
        return "form";
    }

    @RequestMapping(method = RequestMethod.POST)
    public String submit() {
        return "success";
    }

}</code></pre></div>
</div><div class="slide" data-transition="fade"><div class="content smaller" ref="infrastructure/ slides/31">
<h1>The code with the new @MVC</h1>

<h2>Just remove the type-level HTTP method mapping</h2>

<pre class="sh_java"><code>
@Controller
@RequestMapping(value = "/foo")
public class FooController {

    @RequestMapping(method = RequestMethod.GET)
    public String index() {
        return "form";
    }

    @RequestMapping(method = RequestMethod.POST)
    public String submit() {
        return "success";
    }

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/32">
<h1>Is it not a regression?</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/33">
<h1>The upgrade path</h1>

<ul>
<li>Automatic upgrade with the <br> MVC namespace or MVC Java config</br>
<li>You must update configuration otherwise</li>
<li>We recommended you do so</li>
<li>No more new features on old @MVC</li>
</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="infrastructure/ slides/34">
<h2><code>HandlerMethod</code>:</h2>

<h2>An abstraction for various controller methods</h2>

<ul>
<li><code>@RequestMapping</code></li>
<li><code>@ModelAttribute</code></li>
<li><code>@InitBinder</code></li>
<li><code>@ExceptionHandler</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/35">
<h1>How different method arguments are supported</h1>

<pre class="sh_java"><code>

public interface HandlerMethodArgumentResolver {

  boolean supportsParameter(MethodParameter parameter);

  Object resolveArgument(
      MethodParameter parameter, 
      ModelAndViewContainer mavContainer,
      NativeWebRequest webRequest, 
      WebDataBinderFactory binderFactory) throws Exception;

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/36">
<h2>Every built-in method argument has its own <code>HandlerMethodArgumentResolver</code></h2></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="infrastructure/ slides/37">
<h1>How different return value types are supported</h1>

<pre class="sh_java"><code>

public interface HandlerMethodReturnValueHandler {

  boolean supportsReturnType(MethodParameter returnType);

  void handleReturnValue(
    Object returnValue,
    MethodParameter returnType,
    ModelAndViewContainer mavContainer,
    NativeWebRequest webRequest) throws Exception;

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/38">
<h2>Every supported return value has its own <code>HandlerMethodReturnValueHandler</code></h2></div>
</div><div class="slide" data-transition="none"><div class="content incremental bullets" ref="infrastructure/ slides/39">
<h1>The benefits</h1>

<ul>
<li>More flexible</li>
<li>More customizable</li>
<li>Better flexible method signature support</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="infrastructure/ slides/40">
<h1>Demo</h1></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="redirect/slides/1">
<h1>Redirect Attributes</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="redirect/slides/2">
<h2>This stack overflow <a href="http://stackoverflow.com/questions/8972663/do-session-attributes-show-in-url-when-handling-post-redirect-in-spring-mvc-3">post</a> describes the motivation</h2></div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="redirect/slides/3">
<h1><code>RedirectAttributes</code> Example</h1>

<pre class="sh_java"><code>
    @RequestMapping(method=POST)
    public String save(Entity entity, Errors errors,
                       RedirectAttributes redirectAttrs){

        // ...

        redirectAttrs.addAttribute("id", entity.getId);
        redirectAttrs.addAttribute("date", new Date());

        // ...

        redirectAttrs.addFlashAttribute("message", "Yay!");

        return "redirect:/someUrl";
    }</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="redirect/slides/4">
<h1>Why not just use the <code>Model</code>?</h1>

<ul>
<li>The <code>Model</code> has the right content for rendering</li>
<li>Not so much for redirecting</li>
<li>It's usually a different set of attributes</li>
<li>Prefer <code>RedirectAttributes</code> when redirecting for better control</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="redirect/slides/5">
<h1>This is possible</h1>

<pre class="sh_java"><code>
@RequestMapping(method=POST)
public String save(Entity entity, Errors errors,
                   Model model,
                   RedirectAttributes redirectAttrs){


    // Use Model if not redirecting (e.g. Ajax request)


    // Use RedirectAttrs otherwise

}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content" ref="redirect/slides/6">
<h1>Demo</h1>

<h2><a href="https://github.com/SpringSource/spring-mvc-showcase/blob/master/src/main/java/org/springframework/samples/mvc/form/FormController.java">FormController.java</a></h2>

<h2><a href="https://github.com/SpringSource/spring-mvc-showcase">spring-mvc-showcase</a></h2></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="redirect/slides/7">
<h1>How to enable use of <code>RedirectAttributes</code> for all redirects</h1>

<ul>
<li>For example when method signature does not contain <code>RedirectAttributes</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content smaller" ref="redirect/slides/8">
<h1>Example</h1>

<pre class="sh_java"><code>
@RequestMapping(method=POST)
public String save(Entity e, Errors errors, Model model){

    // ...

    return "redirect:/someUrl";
}</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="redirect/slides/9">
<h1>Use <code>RedirectAttributes</code> for all redirects</h1>

<ul>
<li><code>RequestMappingHandlerAdapter</code> property</li>
<li><code>setIgnoreDefaultModelOnRedirect</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="redirect/slides/10">
<h1>Flash attributes</h1>

<ul>
<li>Redirect URL is the intended recipient</li>
<li>But what if another request comes in meanwhile?</li>
<li>Not so unlikely with Ajax requests</li>
<li>Potentially not consumed by intended recipient</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental small" ref="redirect/slides/11">
<h1><code>FlashMap</code></h1>

<ul>
<li>Contains properties with target URL + params</li>
<li>Auto-populated by <code>RedirectView</code></li>
<li>After the redirect <code>FlashMapManager</code> tries to match request to <code>FlashMap</code> instances</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="end/slides/1">
<h1>Looking Forward</h1></div>
</div><div class="slide" data-transition="none"><div class="content" ref="end/slides/2">
<h1>Spring 3.2</h1></div>
</div><div class="slide" data-transition="none"><div class="content incremental bullets small" ref="end/slides/3">
<ul>
<li>Async request processing</li>
<li><a href="http://github.com/SpringSource/spring-test-mvc">spring-test-mvc</a></li>
<li><code>@Resource</code> stereotype <a href="https://jira.springsource.org/browse/SPR-8406">SPR-8406</a></li>
<li>Content negotiation refinements <a href="https://jira.springsource.org/browse/SPR-8410">SPR-8410</a></li>
<li>Global <code>@ExceptionHandler</code> methods</li>
<li>Much more</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content" ref="end/slides/4">
<h1>Hwo to get involved</h1></div>
</div><div class="slide" data-transition="none"><div class="content incremental bullets small" ref="end/slides/5">
<ul>
<li>The Spring Framework <a href="https://github.com/SpringSource/spring-framework#readme">now on Github</a></li>
<li><a href="https://github.com/SpringSource/spring-framework-issues#readme">spring-framework-issues</a> repository</li>
<li>New Gradle-based build (<a href="https://github.com/SpringSource/spring-framework/wiki/Gradle-build-and-release-FAQ">Wiki</a>)</li>
<li>New SpringSource repository (<a href="https://github.com/SpringSource/spring-framework/wiki/SpringSource-repository-FAQ">Wiki</a>)</li>
<li><a href="https://jira.springsource.org/browse/SPR">Spring JIRA</a></li>
</ul>
</div>
</div><div class="slide" data-transition="none">
  <div class="content" ref="end/slides/6">
<h2><strong>Slides Available At</strong><br/>

<br>


<h2><a href="https://github.com/rstoyanchev/spring-mvc-31-indepth">https://github.com/rstoyanchev/spring-mvc-31-indepth</a></h2></br>
</h2>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="end/slides/7">
<h1>Q&amp;A</h1>

<br/>


<h2>Rossen Stoyanchev</h2>

<h3>Twitter: <a href="http://twitter.com/rstoya05">@rstoya05</a></h3></div>
</div></div>

</body>
</html>
